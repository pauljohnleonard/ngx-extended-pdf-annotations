<div
  [ngClass]="{
    'comment-outer-container': true,
    'mat-elevation-z8': true,
    'blue-border': hasFocus
  }"
  (click)="clicked()"
>
  <div class="comment-inner-container">
    <ng-container
      *ngFor="let item of comment.records; first as isFirst; last as isLast"
    >
      <ng-container *ngIf="isFirst || hasFocus">
        <div class="comment-top-meta-info">
          <mat-icon
            *ngIf="item.type === AnnotationItemType.COMMENT"
            class="myicon"
            >gesture</mat-icon
          >

          <span style="width: 20px"></span>
          <div class="comment-name-and-date">
            <div class="name">{{ item.userName }}</div>
            <div class="date">
              {{ date.formatDate(item.createdAt) }}
            </div>
          </div>

          <span class="filler"></span>

          <ng-container *ngIf="item.type === AnnotationItemType.COMMENT">
            <mat-icon
              *ngIf="!item.isPrivate"
              class="myicon"
              matTooltip="Public comment. Click to make private."
              (click)="toogleVisibility()"
              >visibility</mat-icon
            >
            <mat-icon
              *ngIf="item.isPrivate"
              class="myicon"
              matTooltip="Private comment. Click to make public."
              (click)="toogleVisibility()"
              >visibility_off</mat-icon
            >
          </ng-container>

          <div class="chat-message-buttons" *ngIf="hasFocus && isFirst">
            <button
              mat-icon-button
              [matMenuTriggerFor]="deleteMessageMenu"
              class="delete-menu-button"
              [class.delete-menu-button-for-non-admin]="true"
              aria-label="Delete comment menu"
            >
              <mat-icon>more_horiz</mat-icon>
            </button>

            <mat-menu #deleteMessageMenu="matMenu">
              <button
                mat-menu-item
                (click)="annotationService._deleteComment(comment)"
                aria-label="Delete comment"
              >
                <mat-icon>delete</mat-icon>
                <span i18n="@@chat_delete-message">Delete message</span>
              </button>
            </mat-menu>
          </div>
        </div>

        <div class="comment-body-container">
          <div *ngIf="item !== inputRecord" class="comment-body">
            {{ item.bodyValue }}
          </div>
        </div>
        <!-- {{ item.id }} {{ inputRecord.id }} -->
        <mat-form-field
          *ngIf="item === inputRecord"
          class="comment-body-formfield"
          appearance="outline"
        >
          <textarea
            matInput
            class="comment-window-textarea-message-input"
            i18n-placeholder="@@YourCommentPlaceHolder"
            [placeholder]="
              item.type === AnnotationItemType.COMMENT ? 'Comment' : 'Reply'
            "
            [formControl]="inputFormControl"
            autocomplete="off"
            cdkTextareaAutosize
            cdkAutosizeMinRows="1"
            cdkAutosizeMaxRows="5"
            #messageinput
          >
          </textarea>
        </mat-form-field>
        <div
          *ngIf="!isLast"
          style="
            width: 100%;
            background-color: grey;
            height: 1px;
            margin-bottom: 10px;
          "
        ></div>
      </ng-container>
    </ng-container>
    <!-- <div class="controls-container" *ngIf="hasFocus">
      <span class="filler"></span>
      <button
        mat-icon-button
        class="is-replying-info-cancel-button"
        aria-label="Cancel replying to message"
        (click)="clearMessage()"
        i18n-matTooltip="@@ClearCommentBottonng s"
        matTooltip="clear"
      >
        <mat-icon>clear</mat-icon>
      </button>

      <button
        mat-icon-button
        matSuffix
        (click)="comnmitComment()"
        [attr.aria-label]="'Send message'"
        matTooltip="Send message"
        i18n-matTooltip="@@chat_send-message"
      >
        <mat-icon>send</mat-icon>
      </button>
    </div> -->
  </div>
</div>
